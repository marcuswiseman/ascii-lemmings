#include "keys.h"
#include "Draw.h"
#include <iostream>
#include <curses.h>
#include <windows.h>
#include <cstdio>
#include <cstring>
#include <mmsystem.h>
#include <fstream>

using namespace std;

void StartAnimation();
void RevStartAnimation();
void StartLevel();
void LevelSelectAnimation();
void RevLevelSelectAnimation();

int level = 1;
int endgame, endintro, levelloop, selpos, Ahold, AholdTime ,MoveCus;
int GameSpeed = 100;
int AnimationSpeed = 50;
bool Gskip = false;

char SA[25][24][79] = {  "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "|                                       |                                    |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |---------|                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "|                                  |         |                               |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |---------------------|                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "|                            |                     |                         |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |---------------------------------|                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "|                      |                                 |                   |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |--------------------------------------------|              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "|                |                                            |              |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |-------------------------------------------------------|         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "|          |                                                       |         |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |------------------------------------------------------------------|    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "|    |                                                                  |    |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                           i                                |",
                         "|                  i                                                         |",
                         "|            ii     i        i      i        i          ii                   |",
                         "|              ii             i        ii          ii     ii                 |",
                         "|      ii        i        i          i   ii          i      i                |",
                         "|        ii                i                                     ii          |",
                         "|          i                                                       ii        |",
                         "|                                                                    ii      |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                         i                                                  |",
                         "|                  i       i            i                                    |",
                         "|      i     i            i              i  i    i     i                     |",
                         "|       i           i        i      i             i i   i ii                 |",
                         "|             i               i      i       i       i      ii  i            |",
                         "|      i     i     i       i            i   i     i i  i      i       i      |",
                         "|       i           i        i      i        i     i i  i    i         i     |",
                         "|                                    i   i                  i    i    i      |",
                         "|             i                                                        i     |",
                         "|                             i                                              |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|      i     i     i  ii  i  i  ii  i   i   i  i    i  i    i   i            |",
                         "|       i     i     i   i  i  i   i  i   i   i  i    i  i    i   i           |",
                         "|            ii        i         i                                           |",
                         "|      i       ii  i      i  i      i   i   i   i   i  i         ii          |",
                         "|       i           i      i  i      i   i   i   i   i  i          ii        |",
                         "|                                                                    ii      |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|            i     i     i   i     i   ii   ii      i   ii       ii          |",
                         "|      i     ii     i   i i   i   i i    ii   i      i  i ii     i ii        |",
                         "|       i     ii   i i   i i i i   i i  i   ii      i  i    i   i    ii      |",
                         "|      i        i   i     i   i     i    i    ii     i     i          i      |",
                         "|       i        i   i     i   i     i                      i          i     |",
                         "|                     i         i                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|   AS                                                                       |",
                         "|     CI                                                                     |",
                         "|   ^^  I                                                                    |",
                         "|     ^^                                                                     |",
                         "|       ^                                                                    |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                      +                                     |",
                         "|                                      |                                     |",
                         "|                                      |                                     |",
                         "|                                      |                                     |",
                         "|                                      |                                     |",
                         "|                                      |                                     |",
                         "|                                      +                                     |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                                #####++#####                                |",
                         "|                                |  [Fast]  |                                |",
                         "|                                |    ||    |                                |",
                         "|                                |  Normal  |                                |",
                         "|                                |    ||    |                                |",
                         "|                                |   Slow   |                                |",
                         "|                                #####++#####                                |",
                         "------------------------------------------------------------------------------",
                         // space 17
                         "------------------------------------------------------------------------------",
                         "|                  Press Space Button To Select Game Speed                   |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                             ########++########                             |",
                         "|                             |     [Fast]     |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |     Normal     |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |      Slow      |                             |",
                         "|                             ########++########                             |",
                         "------------------------------------------------------------------------------",
                         // space 18
                         "------------------------------------------------------------------------------",
                         "|                  Press Space Button To Select Game Speed                   |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                             ########++########                             |",
                         "|                             |      Fast      |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |    [Normal]    |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |      Slow      |                             |",
                         "|                             ########++########                             |",
                         "------------------------------------------------------------------------------",
                         // space 19
                         "------------------------------------------------------------------------------",
                         "|                    Press Space Button To Select Game Speed                 |",
                         "|                             Arrow Keys To Navigate                         |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|   ASCII                                                                    |",
                         "|   ^^^^^                                                                    |",
                         "|      ii    iiiii iii   iii iii   iii iiii iii     ii  iiiii    iiiiii      |",
                         "|      ii    ii    iiii iiii iiii iiii  ii  iiii    ii ii   ii  ii    ii     |",
                         "|      ii    ii    ii iii ii ii iii ii  ii  ii ii   ii ii   ii  ii           |",
                         "|      ii    iiii  ii  i  ii ii  i  ii  ii  ii  ii  ii ii        iiiiii      |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii   ii ii ii iiiii       ii     |",
                         "|      ii    ii    ii     ii ii     ii  ii  ii    iiii ii   ii  ii    ii     |",
                         "|      iiiii iiiii ii     ii ii     ii iiii ii     iii  iiiii    iiiiii      |",
                         "|----------------------------------------------------------------------------|",
                         "|                             ########++########                             |",
                         "|                             |      Fast      |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |     Normal     |                             |",
                         "|                             |       ||       |                             |",
                         "|                             |     [Slow]     |                             |",
                         "|                             ########++########                             |",
                         "------------------------------------------------------------------------------",
                         // space 20
                         "------------------------------------------------------------------------------",
                         "|                    Press Space Button To Select Level                      |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                     +                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     |                                      |",
                         "|                                     +                                      |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space 21
                         "------------------------------------------------------------------------------",
                         "|                  Press Space Button To Select Game Speed                   |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                               #####+++#####                                |",
                         "|                               |Level|1]   |                                |",
                         "|                               |Level|2    |                                |",
                         "|                               |Level|3    |                                |",
                         "|                               |Level|4    |                                |",
                         "|                               |Level|5    |                                |",
                         "|                               |Level|6    |                                |",
                         "|                               |Level|7    |                                |",
                         "|                               |Level|8    |                                |",
                         "|                               |Level|9    |                                |",
                         "|                               |Level|10   |                                |",
                         "|                               |Level|11   |                                |",
                         "|                               |Level|12   |                                |",
                         "|                               |Level|13   |                                |",
                         "|                               #####+++#####                                |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space 22
                         "------------------------------------------------------------------------------",
                         "|                  Press Space Button To Select Game Speed                   |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                            ########+++########                             |",
                         "|                            |  [Level|1]   [x]|                             |",
                         "|                            |   Level|2     x |                             |",
                         "|                            |   Level|3     x |                             |",
                         "|                            |   Level|4     x |                             |",
                         "|                            |   Level|5     x |                             |",
                         "|                            |   Level|6     x |                             |",
                         "|                            |   Level|7     x |                             |",
                         "|                            |   Level|8     x |                             |",
                         "|                            |   Level|9     x |                             |",
                         "|                            |   Level|10    x |                             |",
                         "|                            |   Level|11    x |                             |",
                         "|                            |   Level|12    x |                             |",
                         "|                            |   Level|13    x |                             |",
                         "|                            ########+++########                             |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                         // space
                         "------------------------------------------------------------------------------",
                         "|                  Press Space Button To Select Game Speed                   |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                            ########+++########                             |",
                         "|                            |   Level|1     x |                             |",
                         "|                            |  [Level|2]   [x]|                             |",
                         "|                            |   Level|3     x |                             |",
                         "|                            |   Level|4     x |                             |",
                         "|                            |   Level|5     x |                             |",
                         "|                            |   Level|6     x |                             |",
                         "|                            |   Level|7     x |                             |",
                         "|                            |   Level|8     x |                             |",
                         "|                            |   Level|9     x |                             |",
                         "|                            |   Level|10    x |                             |",
                         "|                            |   Level|11    x |                             |",
                         "|                            |   Level|12    x |                             |",
                         "|                            |   Level|13    x |                             |",
                         "|                            ########+++########                             |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "|                                                                            |",
                         "------------------------------------------------------------------------------",
                      };

BOOL NT_SetConsoleDisplayMode(HANDLE hOutputHandle, DWORD dwNewMode)
{
    typedef BOOL (WINAPI *SCDMProc_t) (HANDLE, DWORD, LPDWORD);
    SCDMProc_t SetConsoleDisplayMode;
    HMODULE hKernel32;
    BOOL bFreeLib = FALSE, ret;
    const char KERNEL32_NAME[] = "kernel32.dll";

    hKernel32 = GetModuleHandleA(KERNEL32_NAME);
    if (hKernel32 == NULL)
    {
        hKernel32 = LoadLibraryA(KERNEL32_NAME);
        if (hKernel32 == NULL)
            return FALSE;

        bFreeLib = true;
    }//if

    SetConsoleDisplayMode =
        (SCDMProc_t)GetProcAddress(hKernel32, "SetConsoleDisplayMode");
    if (SetConsoleDisplayMode == NULL)
    {
        SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
        ret = FALSE;
    }//if
    else
    {
        DWORD dummy;
        ret = SetConsoleDisplayMode(hOutputHandle, dwNewMode, &dummy);
    }//else

    if (bFreeLib)
        FreeLibrary(hKernel32);

    return ret;
}//NT_SetConsoleDisplayMode

void PlaySound2(char* filename,bool loop)
{
    if (loop == true)
    {
        PlaySound(TEXT (filename),NULL,SND_FILENAME | SND_ASYNC | SND_NOSTOP | SND_LOOP);
    }
    else
    {
        PlaySound(TEXT (filename),NULL,SND_FILENAME | SND_ASYNC | SND_NOSTOP | SND_NOWAIT);
    }
}

void init()
{
    initscr();
    system("title Lemmings");
    NT_SetConsoleDisplayMode( GetStdHandle( STD_OUTPUT_HANDLE ), 1 );
    raw();
    nodelay(stdscr,1);
    noecho();
    curs_set(0);
    nonl();
    keypad(stdscr,1);
    start_color();
    init_pair (1, COLOR_WHITE,COLOR_BLACK);
    init_pair (2, COLOR_GREEN,COLOR_BLACK);
    init_pair (3, COLOR_BLUE,COLOR_BLACK);
    init_pair (4, COLOR_RED,COLOR_BLACK);
    init_pair (5, COLOR_YELLOW,COLOR_BLACK);
    init_pair (6, COLOR_GREEN,COLOR_GREEN);
    init_pair (7, COLOR_WHITE,COLOR_BLACK);
    init_pair (8, COLOR_BLACK,COLOR_WHITE);
    init_pair (9, COLOR_CYAN,COLOR_BLACK);
}

void DrawSA(int num)
{
    clear();
    for (int y = 0; y < 24; y++)
    {
        for (int x = 0; x < 79; x++)
        {
            switch (SA[num][y][x])
            {
            case ' ':
            {
                mvaddch(y,x,SA[num][y][x]);
            }
            break;
            case '-':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(4)|A_BOLD);
            }
            break;
            case '|':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(4)|A_BOLD);
            }
            break;
            case '+':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(1)|A_BOLD);
            }
            break;
            case '[':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(5)|A_BOLD);
            }
            break;
            case ']':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(5)|A_BOLD);
            }
            break;
            case 'i':
            {
                mvaddch(y,x,SA[num][y][x]|COLOR_PAIR(2)|A_BOLD);
            }
            break;
            default:
            {
                if (SA[num][y][x] != 0)
                {
                    mvaddch(y,x,SA[num][y][x]);
                }
            }
            break;
            }
        }
    }
    refresh();
    napms(AnimationSpeed);
}

int main()
{
    init();
    PlaySound2("Danu's Lemmings III - Classic Track 2.wav",true);
    StartAnimation();
    selpos = 0;
    napms(GameSpeed);
    do   // main menu loop
    {
        int keyi = getch();
        if (keyi == ' ')
        {
            if (selpos == 0)
            {
                GameSpeed = 200;
                endintro = 1;
                RevStartAnimation();
            }
            else if (selpos == 1)
            {
                GameSpeed =  500;
                endintro = 1;
                RevStartAnimation();
            }
            else if (selpos == 2)
            {
                GameSpeed = 1000;
                endintro = 1;
                RevStartAnimation();
            }
        }
        if (endintro == 1)
        {
            StartLevel();
        }
        if (keyi == KEY_UP)
        {
            selpos--;
        }
        if (keyi == KEY_DOWN)
        {
            selpos++;
        }
        if (selpos > 2)
        {
            selpos = 0;
        }
        if (selpos < 0)
        {
            selpos = 2;
        }
        if (selpos == 0)
        {
            DrawSA(17);
        }
        if (selpos == 1)
        {
            DrawSA(18);
        }
        if (selpos == 2)
        {
            DrawSA(19);
        }
        napms(GameSpeed);
    }
    while ( endintro != 2);
    return 0;
}

void LevelSelectAnimation()
{
    int i = 20;
    do
    {
        if (i != 23)
        {
            clear();
            for (int y = 0; y < 24; y++)
            {
                for (int x = 0; x < 79; x++)
                {
                    switch (SA[i][y][x])
                    {
                    case ' ':
                    {
                        mvaddch(y,x,SA[i][y][x]);
                    }
                    break;
                    case '-':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '|':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '+':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(1)|A_BOLD);
                    }
                    break;
                    case '[':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case ']':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case 'i':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(2)|A_BOLD);
                    }
                    break;
                    default:
                    {
                        if (SA[i][y][x] != 0)
                        {
                            mvaddch(y,x,SA[i][y][x]);
                        }
                    }
                    break;
                    }
                }
            }
            refresh();
            napms(AnimationSpeed);
            i++;
        }
    }
    while (i != 23);
}

void RevLevelSelectAnimation()
{
    int i = 22;
    do
    {
        if (i != 20)
        {
            clear();
            for (int y = 0; y < 24; y++)
            {
                for (int x = 0; x < 79; x++)
                {
                    switch (SA[i][y][x])
                    {
                    case ' ':
                    {
                        mvaddch(y,x,SA[i][y][x]);
                    }
                    break;
                    case '-':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '|':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '+':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(1)|A_BOLD);
                    }
                    break;
                    case '[':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case ']':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case 'i':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(2)|A_BOLD);
                    }
                    break;
                    default:
                    {
                        if (SA[i][y][x] != 0)
                        {
                            mvaddch(y,x,SA[i][y][x]);
                        }
                    }
                    break;
                    }
                }
            }
            refresh();
            napms(AnimationSpeed);
            i--;
        }
    }
    while (i != 20);
}

void StartAnimation()
{
    int i = 0;
    do
    {
        if (i != 18)
        {
            clear();
            for (int y = 0; y < 24; y++)
            {
                for (int x = 0; x < 79; x++)
                {
                    switch (SA[i][y][x])
                    {
                    case ' ':
                    {
                        mvaddch(y,x,SA[i][y][x]);
                    }
                    break;
                    case '-':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '|':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '+':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(1)|A_BOLD);
                    }
                    break;
                    case '[':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case ']':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case 'i':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(2)|A_BOLD);
                    }
                    break;
                    default:
                    {
                        if (SA[i][y][x] != 0)
                        {
                            mvaddch(y,x,SA[i][y][x]);
                        }
                    }
                    break;
                    }
                }
            }
            refresh();
            napms(AnimationSpeed);
            i++;
        }
    }
    while (i != 18);
}

void RevStartAnimation()
{
    int i = 15;
    do
    {
        if (i != 0)
        {
            clear();
            for (int y = 0; y < 24; y++)
            {
                for (int x = 0; x < 79; x++)
                {
                    switch (SA[i][y][x])
                    {
                    case ' ':
                    {
                        mvaddch(y,x,SA[i][y][x]);
                    }
                    break;
                    case '-':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '|':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(4)|A_BOLD);
                    }
                    break;
                    case '+':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(1)|A_BOLD);
                    }
                    break;
                    case '[':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case ']':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(5)|A_BOLD);
                    }
                    break;
                    case 'i':
                    {
                        mvaddch(y,x,SA[i][y][x]|COLOR_PAIR(2)|A_BOLD);
                    }
                    break;
                    default:
                    {
                        if (SA[i][y][x] != 0)
                        {
                            mvaddch(y,x,SA[i][y][x]);
                        }
                    }
                    break;
                    }
                }
            }
            refresh();
            napms(AnimationSpeed);
            i--;
        }
    }
    while (i != 0);
}

void StartLevel()
{
    bool levelnew = false;
    int level = 1;
    int selp = 0;
    while (levelnew == false)
    {
        int key2 = getch();
        if (key2 == ' ')
        {
            if (selp == 0)
            {
                level = 1;
                levelnew = true;
                Gskip = true;
            }
            else if (selp == 1)
            {
                ifstream setfile;
                setfile.open("Settings.txt");
                string line;

                if (!setfile.is_open())
                {
                    level = 1;
                    levelnew = true;
                }
                else
                {
                    setfile >> level;
                    levelnew = true;
                }
                setfile.close();
                Gskip = true;
            }
        }
        else if (Gskip == false)
        {
            if (key2 == KEY_UP)
            {
                selp--;
            }
            if (key2 == KEY_DOWN)
            {
                selp++;
            }
            if (selp > 1)
            {
                selp = 0;
            }
            else if (selp < 0)
            {
                selp = 1;
            }
            clear();
            if (selp == 0)
            {
                mvprintw(1,1,"New Game <<");
                mvprintw(2,1,"Resume Game");
            }
            if (selp == 1)
            {
                mvprintw(1,1,"New Game");
                mvprintw(2,1,"Resume Game <<");
            }
            refresh();
            Sleep(GameSpeed);
        }
    }
    reset();
    CheckLevel(level);
    PlaySound(NULL,0,0);
    do
    {
        int keyl = getch();
        if (GetAsyncKeyState(VK_ESCAPE))
        {
            endgame = 1;
        }
        DrawMap();
        if (level == 12)
        {
            clear();
            cout << "YOU HAVE COMPLETED THE GAME!" << endl;
            system("pause");
            refresh();
            levelnew = false;
            Gskip = false;
            GameSpeed = 2000;
            endgame = 1;
        }
    }
    while ((endgame != 1));
    endintro = 0;
    Gskip = false;
    endgame = 0;
}
